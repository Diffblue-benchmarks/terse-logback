package com.tersesystems.logback;

import org.slf4j.Logger;
import java.util.function.Consumer;
import java.util.function.Supplier;

@* "sbt generateSources" autogenerates in target/sources/txt.Results *@
public class ProxyLogControl implements LogControl @ob

    private final Logger logger;
    private final Supplier<Boolean> predicate;

    public ProxyLogControl(Logger logger) {
        this.logger = logger;
        this.predicate = () -> true;
    }

    public ProxyLogControl(Logger logger, Supplier<Boolean> predicate) {
        this.logger = logger;
        this.predicate = predicate;
    }

    @for(level <- Seq(
      Level("trace", "Trace"),
      Level("debug", "Debug"),
      Level("info", "Info"),
      Level("warn", "Warn"),
      Level("error", "Error"),
    )) {
    public void if@{level.capitalizedName}(Consumer<Logger> lc) @ob
        if (logger.is@{level.capitalizedName}Enabled() && predicate.get()) @ob
            lc.accept(logger);
        @cb
    @cb

    public void if@{level.capitalizedName}(Supplier<Boolean> condition, Consumer<Logger> lc) @ob
        if (logger.is@{level.capitalizedName}Enabled() && predicate.get() && condition.get()) @ob
            lc.accept(logger);
        @cb
    @cb
    }
@cb